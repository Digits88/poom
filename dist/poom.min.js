/*! @license Poom v0.1.0

Copyright 2017 Fisssion LLC. All rights reserved.

*/
var Poom=function(){"use strict";function t(t){return null!==t&&t instanceof Object&&(t.constructor===Object||"[object Object]"===Object.prototype.toString.call(t))}function e(e,o){if(t(e)){return Object.keys(e).forEach(function(t){return o(e[t],t,e)})}if(e instanceof Array)return e.forEach(function(t,i){return o(t,i,e)});throw new TypeError("Expected either an array or object literal.")}function o(i){for(var r=arguments,n=[],a=arguments.length-1;a-- >0;)n[a]=r[a+1];if(t(i))return e(n,function(r){e(r,function(e,r){t(e)?(i[r]&&t(i[r])||(i[r]={}),o(i[r],e)):i[r]=e})}),i;throw new TypeError("Target must be an object literal.")}function i(t,e){if(void 0===e&&(e=document),"string"==typeof t)try{return e.querySelector(t)}catch(t){return null}return function(t){return"object"==typeof window.Node?t instanceof window.Node:null!==t&&"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName}(t)?t:null}function r(t,e){if(void 0===e&&(e={}),this.root=i(t),!this.root)throw new Error("No target found.");if(!function(t){var e=!1;if(t.children)e=0!==t.children.length;else for(var o=t.firstChild;!e&&o;o=o.nextSibling)1==o.nodeType&&(e=!0);return e}(this.root))throw new Error("Target has no children.");this.id=f++;var n=o({},{vertical:!1,horizontal:!1,ratio:null,size:null,scrolled:null},e);for(this.setState(n),this.scrollable=document.createElement("div"),n.horizontal?this.scrollable.setAttribute("data-poom-scrollable-x",""):this.scrollable.setAttribute("data-poom-scrollable-y","");this.root.firstChild;)this.scrollable.appendChild(this.root.firstChild);this.bar=document.createElement("div"),this.bar.setAttribute("data-poom-bar",""),this.viewable=document.createElement("div"),this.viewable.setAttribute("data-poom-viewable",""),this.viewable.appendChild(this.scrollable),this.viewable.appendChild(this.bar),this.root.setAttribute("data-poom-root",this.id),this.root.appendChild(this.viewable),this.handleDown=function(t){var e=r.state[this.id];e.vertical&&!e.horizontal&&this.setState({lastPosition:t.clientY});e.horizontal&&!e.vertical&&this.setState({lastPosition:t.clientX});document.addEventListener("mousemove",this.handleMove),document.addEventListener("mouseup",this.handleUp)}.bind(this),this.handleMove=function(t){var e=this,o=r.state[this.id];s(function(){if(o.vertical&&!o.horizontal){var i=t.clientY-o.lastPosition;e.setState({lastPosition:t.clientY}),e.scrollable.scrollTop+=i/o.ratio}if(o.horizontal&&!o.vertical){var r=t.clientX-o.lastPosition;e.setState({lastPosition:t.clientX}),e.scrollable.scrollLeft+=r/o.ratio}})}.bind(this),this.handleUp=function(){document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)}.bind(this),this.update=function(){var t=this;s(function(){var e,o,i,n=r.state[t.id];n.vertical&&!n.horizontal&&(e=t.scrollable.clientHeight,o=t.scrollable.scrollTop,i=t.scrollable.scrollHeight),n.horizontal&&!n.vertical&&(e=t.scrollable.clientWidth,o=t.scrollable.scrollLeft,i=t.scrollable.scrollWidth);var a=o/i*100,l=e/i,s=Math.max(100*l,10);t.setState({ratio:l,scrolled:a,size:s})})}.bind(this),window.addEventListener("resize",this.update),this.bar.addEventListener("mousedown",this.handleDown),this.scrollable.addEventListener("scroll",this.update),this.setState({instance:this}),this.update()}var n,a,l=function(){var t=Date.now();return function(e){var o=Date.now();o-t>16?(t=o,e(o)):setTimeout(function(){return l(e)},0)}}(),s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||l,c=function(){var t=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");return e.type="text/css",function(o){if(e.styleSheet)e.styleSheet.cssText=o;else{for(var i=document.createTextNode(o);e.firstChild;)e.firstChild.remove();e.appendChild(i)}t.appendChild(e)}}(),d=function(o){var i=[];return e(o,function(e,o){return i.push(function(e,o){try{document.querySelector(e)}catch(t){throw new Error("Selector is not valid.")}if(!t(o)||!Object.keys(o).length>0)throw new Error("No object properties found.");var i=e.split(",").map(function(t){return t.trim()}).join(",\n")+" {";return(i+=Object.keys(o).sort().reduce(function(t,e){return t+="\n\t"+function(t){return t.replace(/_/g,"").replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()}(e)+": "+o[e]+";"},""))+"\n}"}(o,e))}),i.join("\n")},h={"[data-poom-scrollable-x]":{overflowX:"auto",overflowY:"hidden"},"[data-poom-scrollable-y]":{overflowY:"auto",overflowX:"hidden"},"[data-poom-scrollable-x], [data-poom-scrollable-y]":{position:"absolute",top:"-20px",right:"-20px",bottom:"-20px",left:"-20px",padding:"20px"},"[data-poom-viewable]":{position:"absolute",overflow:"hidden",top:0,right:0,bottom:0,left:0},"[data-poom-bar]":{position:"absolute"}},u=function(t,e){return a={},a['[data-poom-root="'+e+'"] [data-poom-bar]']=(n={},n[t.horizontal?"width":"height"]=(t.size||10)+"%",n[t.horizontal?"left":"top"]=(t.scrolled||0)+"%",n[t.horizontal?"bottom":"right"]=0,n[t.horizontal?"height":"width"]="10px",n),a},f=0,p={};return Object.defineProperty(r,"state",{get:function(){return p}}),Object.defineProperty(r,"setState",{get:function(){return function(i){var n;return t(i)&&(n=i),"function"==typeof i&&(n=i(p)),p=o({},p,n),function(){var t=[];e(r.state,function(e,o,i){var r=u(i[o],o);t.push(r)});var i=o.apply(void 0,[{},h].concat(t)),n=d(i);c(n)}(),p}}}),r.prototype.setState=function(e){var o,i;return t(e)?r.setState((o={},o[this.id]=e,o)):"function"==typeof e?r.setState((i={},i[this.id]=e(p),i)):void 0},r}();
